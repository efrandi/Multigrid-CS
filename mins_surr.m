function incr = mins_surr(z,xt,i,j,n,deltaP,deltaM)

incr = [0;0];
h = 1/n;

a = z(2,3)-z(2,2); b = z(2,3)-z(3,3);
c = z(2,2)-z(3,2); d = z(3,3)-z(3,2);
e = z(1,2)-z(1,1); g = z(1,2)-z(2,2);
p = z(1,1)-z(2,1); q = z(2,2)-z(2,1);

%positive search direction
i11 = (deltaP^2-2*deltaP*a)/(sqrt(h^2+(a-deltaP)^2+b^2)+sqrt(h^2+a^2+b^2)) + ...
       (deltaP^2+2*deltaP*c)/(sqrt(h^2+(c+deltaP)^2+d^2)+sqrt(h^2+c^2+d^2)) + ...
       (deltaP^2-2*deltaP*g)/(sqrt(h^2+(g-deltaP)^2+e^2)+sqrt(h^2+g^2+e^2)) + ...
       (deltaP^2+2*deltaP*q)/(sqrt(h^2+(q+deltaP)^2+p^2)+sqrt(h^2+q^2+p^2)) + ...
       (2*deltaP*(deltaP-g-a))/(sqrt(h^2+(g-deltaP)^2+(a-deltaP)^2)+sqrt(h^2+g^2+a^2)) + ...
       (2*deltaP*(deltaP+q+c))/(sqrt(h^2+(q+deltaP)^2+(c+deltaP)^2)+sqrt(h^2+q^2+c^2));
i11 = .5*h*i11;

%negative search direction
i21 = (deltaM^2+2*deltaM*a)/(sqrt(h^2+(a+deltaM)^2+b^2)+sqrt(h^2+a^2+b^2)) + ...
       (deltaM^2-2*deltaM*c)/(sqrt(h^2+(c-deltaM)^2+d^2)+sqrt(h^2+c^2+d^2)) + ...
       (deltaM^2+2*deltaM*g)/(sqrt(h^2+(g+deltaM)^2+e^2)+sqrt(h^2+g^2+e^2)) + ...
       (deltaM^2-2*deltaM*q)/(sqrt(h^2+(q-deltaM)^2+p^2)+sqrt(h^2+q^2+p^2)) + ...
       (2*deltaM*(deltaM+g+a))/(sqrt(h^2+(g+deltaM)^2+(a+deltaM)^2)+sqrt(h^2+g^2+a^2)) + ...
       (2*deltaM*(deltaM-q-c))/(sqrt(h^2+(q-deltaM)^2+(c-deltaM)^2)+sqrt(h^2+q^2+c^2));  
i21 = .5*h*i21;

xt(1:3,1:3) = xt(1:3,1:3)-z(1:3,1:3);

a = xt(2,3)-xt(2,2); b = xt(2,3)-xt(3,3);
c = xt(2,2)-xt(3,2); d = xt(3,3)-xt(3,2);
e = xt(1,2)-xt(1,1); g = xt(1,2)-xt(2,2);
p = xt(1,1)-xt(2,1); q = xt(2,2)-xt(2,1);

%positive search direction
i12 = (deltaP^2+2*deltaP*a)/(sqrt(h^2+(a+deltaP)^2+b^2)+sqrt(h^2+a^2+b^2)) + ...
       (deltaP^2-2*deltaP*c)/(sqrt(h^2+(c-deltaP)^2+d^2)+sqrt(h^2+c^2+d^2)) + ...
       (deltaP^2+2*deltaP*g)/(sqrt(h^2+(g+deltaP)^2+e^2)+sqrt(h^2+g^2+e^2)) + ...
       (deltaP^2-2*deltaP*q)/(sqrt(h^2+(q-deltaP)^2+p^2)+sqrt(h^2+q^2+p^2)) + ...
       (-2*deltaP*(-deltaP-g-a))/(sqrt(h^2+(g+deltaP)^2+(a+deltaP)^2)+sqrt(h^2+g^2+a^2)) + ...
       (-2*deltaP*(-deltaP+q+c))/(sqrt(h^2+(q-deltaP)^2+(c-deltaP)^2)+sqrt(h^2+q^2+c^2));
i12 = .5*h*i12;

%negative search direction
i22 = (deltaM^2-2*deltaM*a)/(sqrt(h^2+(a-deltaM)^2+b^2)+sqrt(h^2+a^2+b^2)) + ...
       (deltaM^2+2*deltaM*c)/(sqrt(h^2+(c+deltaM)^2+d^2)+sqrt(h^2+c^2+d^2)) + ...
       (deltaM^2-2*deltaM*g)/(sqrt(h^2+(g-deltaM)^2+e^2)+sqrt(h^2+g^2+e^2)) + ...
       (deltaM^2+2*deltaM*q)/(sqrt(h^2+(q+deltaM)^2+p^2)+sqrt(h^2+q^2+p^2)) + ...
       (-2*deltaM*(-deltaM+g+a))/(sqrt(h^2+(g-deltaM)^2+(a-deltaM)^2)+sqrt(h^2+g^2+a^2)) + ...
       (-2*deltaM*(-deltaM-q-c))/(sqrt(h^2+(q+deltaM)^2+(c+deltaM)^2)+sqrt(h^2+q^2+c^2));  
i22 = .5*h*i22;

incr(1) = 0.5*(i11+i12);
incr(2) = 0.5*(i21+i22);